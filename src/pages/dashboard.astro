---
import DashboardLayout from '../layouts/DashboardLayout.astro';
import ChatPanel from '../components/react/ChatPanel';
import Sidebar from '../components/react/Sidebar';
import ExecutionsPanel from '../components/react/ExecutionsPanel';
import ProjectDetails from '../components/react/ProjectDetails';

const user = Astro.locals.user;
---

<DashboardLayout title="Dashboard">
  <div class="h-[calc(100vh-73px)] flex">
    <!-- Sidebar (Projects/Agents) -->
    <Sidebar client:load userId={user?.id || 'anonymous'} />

    <!-- Main Chat Area -->
    <div class="flex-1 flex flex-col">
      <ChatPanel client:load userId={user?.id || 'anonymous'} />
    </div>

    <!-- Right Panel - Project Details + Executions -->
    <aside class="w-80 flex flex-col border-l border-vs-border">
      <!-- Project Details (top half) -->
      <div class="h-1/2 overflow-hidden">
        <ProjectDetails client:load />
      </div>

      <!-- Executions (bottom half) -->
      <div class="h-1/2 border-t border-vs-border bg-vs-card p-4 flex flex-col overflow-hidden">
        <ExecutionsPanel client:load />
      </div>
    </aside>
  </div>
</DashboardLayout>
