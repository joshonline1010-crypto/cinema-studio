import{j as e}from"./jsx-runtime.BG36-YHJ.js";import{r}from"./index.y5FlbPQu.js";function b({userId:h}){const[t,c]=r.useState(null),[n,o]=r.useState(!0),[a,x]=r.useState(null);r.useEffect(()=>{d()},[]);const d=async()=>{try{const l=await(await fetch("/api/insights")).json();c(l)}catch{x("Failed to load insights")}finally{o(!1)}};if(n)return e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"w-8 h-8 border-4 border-violet-500 border-t-transparent rounded-full animate-spin"})});if(a||!t)return e.jsx("div",{className:"flex items-center justify-center h-full text-red-400",children:a||"No insights available"});const m={love:"bg-green-500",like:"bg-green-400",ok:"bg-gray-400",meh:"bg-yellow-400",dislike:"bg-orange-400",hate:"bg-red-500"};return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Astrix Insights"}),e.jsx("button",{onClick:d,className:"px-4 py-2 bg-violet-600 hover:bg-violet-500 rounded-lg text-sm",children:"Refresh"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"bg-vs-card border border-vs-border rounded-xl p-4",children:[e.jsx("div",{className:"text-3xl font-bold text-violet-400",children:t.overview.total_messages}),e.jsx("div",{className:"text-sm text-white/50",children:"Messages"})]}),e.jsxs("div",{className:"bg-vs-card border border-vs-border rounded-xl p-4",children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-400",children:t.overview.total_likes}),e.jsx("div",{className:"text-sm text-white/50",children:"Likes"})]}),e.jsxs("div",{className:"bg-vs-card border border-vs-border rounded-xl p-4",children:[e.jsx("div",{className:"text-3xl font-bold text-orange-400",children:t.overview.total_changes}),e.jsx("div",{className:"text-sm text-white/50",children:"Change Requests"})]}),e.jsxs("div",{className:"bg-vs-card border border-vs-border rounded-xl p-4",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-400",children:t.overview.images_generated}),e.jsx("div",{className:"text-sm text-white/50",children:"Images"})]}),e.jsxs("div",{className:"bg-vs-card border border-vs-border rounded-xl p-4",children:[e.jsx("div",{className:"text-3xl font-bold text-green-400",children:t.overview.videos_generated}),e.jsx("div",{className:"text-sm text-white/50",children:"Videos"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-vs-card border border-vs-border rounded-xl p-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Sentiment Distribution"}),e.jsx("div",{className:"space-y-2",children:Object.entries(t.sentiment).map(([s,l])=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-20 text-sm capitalize",children:s}),e.jsx("div",{className:"flex-1 bg-white/10 rounded-full h-4",children:e.jsx("div",{className:`h-full rounded-full ${m[s]||"bg-gray-500"}`,style:{width:`${Math.min(100,l/Math.max(1,t.overview.total_messages)*100)}%`}})}),e.jsx("div",{className:"w-12 text-sm text-right",children:l})]},s))})]}),e.jsxs("div",{className:"bg-vs-card border border-vs-border rounded-xl p-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Top Agents"}),e.jsx("div",{className:"space-y-2",children:t.top_agents.length>0?t.top_agents.map((s,l)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-violet-500/20 flex items-center justify-center text-xs",children:l+1}),e.jsx("div",{className:"flex-1 text-sm truncate",children:s.agent}),e.jsxs("div",{className:"text-sm text-white/50",children:[s.count," uses"]})]},s.agent)):e.jsx("div",{className:"text-white/40 text-sm",children:"No agent data yet"})})]}),e.jsxs("div",{className:"bg-vs-card border border-vs-border rounded-xl p-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Common Change Patterns"}),e.jsx("div",{className:"space-y-3",children:t.common_changes.length>0?t.common_changes.map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium capitalize",children:s.pattern}),e.jsx("div",{className:"text-xs text-white/40",children:s.keywords.slice(0,3).join(", ")})]}),e.jsxs("div",{className:"px-2 py-1 bg-orange-500/20 text-orange-400 rounded text-sm",children:[s.count,"x"]})]},s.pattern)):e.jsx("div",{className:"text-white/40 text-sm",children:"No change patterns detected yet"})})]}),e.jsxs("div",{className:"bg-vs-card border border-vs-border rounded-xl p-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Priority Summary (★)"}),e.jsx("div",{className:"grid grid-cols-5 gap-2",children:[{key:"minor",label:"★",color:"bg-gray-500"},{key:"watching",label:"★★",color:"bg-blue-500"},{key:"should_fix",label:"★★★",color:"bg-yellow-500"},{key:"fix_now",label:"★★★★",color:"bg-orange-500"},{key:"human_needed",label:"★★★★★",color:"bg-red-500"}].map(s=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`${s.color} rounded-lg p-2 mb-1`,children:e.jsx("div",{className:"text-xl font-bold",children:t.priority_summary[s.key]||0})}),e.jsx("div",{className:"text-xs text-white/50",children:s.label})]},s.key))})]})]}),e.jsxs("div",{className:"bg-vs-card border border-vs-border rounded-xl p-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Top Rated Outputs"}),t.top_rated.length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4",children:t.top_rated.map((s,l)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:s.mediaUrl,alt:"",className:"w-full aspect-square object-cover rounded-lg"}),e.jsxs("div",{className:"absolute top-2 right-2 bg-black/70 px-2 py-1 rounded text-xs flex items-center gap-1",children:[e.jsx("span",{className:"text-yellow-400",children:"★"}),s.stars]}),e.jsx("div",{className:"absolute inset-0 bg-black/70 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg p-2 flex items-end",children:e.jsx("p",{className:"text-xs line-clamp-3",children:s.prompt})})]},l))}):e.jsx("div",{className:"text-white/40 text-sm text-center py-8",children:"No rated outputs yet. Star your favorite images in chat!"})]}),e.jsxs("div",{className:"bg-vs-card border border-vs-border rounded-xl p-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Recent Change Requests"}),t.recent_changes.length>0?e.jsx("div",{className:"space-y-2",children:t.recent_changes.map((s,l)=>e.jsxs("div",{className:"flex items-start gap-3 p-2 bg-white/5 rounded-lg",children:[e.jsx("div",{className:"flex gap-1 flex-wrap",children:s.patterns.map(i=>e.jsx("span",{className:"px-2 py-0.5 bg-orange-500/20 text-orange-400 rounded text-xs capitalize",children:i},i))}),e.jsx("div",{className:"flex-1 text-sm text-white/70 truncate",children:s.message}),e.jsx("div",{className:"text-xs text-white/40",children:new Date(s.timestamp).toLocaleTimeString()})]},l))}):e.jsx("div",{className:"text-white/40 text-sm text-center py-4",children:"No change requests recorded yet"})]})]})}export{b as default};
